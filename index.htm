<!DOCTYPE html>
<html>
    <body>
        <input type="file" id="file" style="display:none" />
        <input type="button" id="upload" value="UPLOAD" />
        <a id="download" style="display:none">hehe</a>

        
        <script src="wasm_exec.js"></script>
        <script type="text/javascript">
            const go = new Go();
            WebAssembly.instantiateStreaming(fetch("image-upload.wasm"), go.importObject).then((result) => {
                go.run(result.instance);
                
                
                const finputDOM = document.getElementById("file")
                const buttonDOM = document.getElementById("upload")
                const downloadDOM = document.getElementById("download")

                finputDOM.onchange = e => {
                    if (e.target.files && e.target.files[0]) {
                        for (let i = 0; i < e.target.files.length; i++) {
                            var reader = new FileReader();
                            reader.onloadend = (buf) => {
                                const result = buf.target.result;
                                const length = result.byteLength;

                                const resultUint = new Uint8Array(result);

                                const size = GetSize(length, resultUint);
                                console.log(size);

                                
                                const gg = CenterCrop(length, resultUint, size.width / 2 , size.height /2, 1, 1, 10000);
                                console.log(gg);
                            };
                            reader.readAsArrayBuffer(e.target.files[i]);
                        }
                    }
                }
                buttonDOM.onclick = e => {
                    finputDOM.click()
                }
                ;
            });
        </script>
    </body>
</html>